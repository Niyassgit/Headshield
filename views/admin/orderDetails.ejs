<%- include("../partials/admin/header") %>
<style>
    /* General Styles */
    body {
        font-family: 'Inter', system-ui, -apple-system, sans-serif;
        background-color: #f4f4f9;
        margin: 0;
        padding: 0;
        color: #333;
    }

    /* Admin Order Container */
    .order-container {
        width: 90%;
        max-width: 1200px;
        margin: 2rem auto;
        padding: 2rem;
        background-color: #fff;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        border-radius: 16px;
    }

    /* Header Section */
    .order-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 1.5rem;
        margin-bottom: 2rem;
        border-bottom: 2px solid #f1f1f1;
    }

    .order-header h2 {
        margin: 0;
        font-weight: 600;
    }

    .status-badge {
        padding: 0.5rem 1rem;
        border-radius: 50px;
        font-size: 0.875rem;
        font-weight: 500;
    }

    /* Product Box - Updated */
    .product-box {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding: 1.5rem;
        background-color: #ffffff;
        border: 1px solid #eaeaea;
        border-radius: 12px;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .product-box:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    }

    .product-details {
        flex: 1;
        padding-right: 2rem;
    }

    .product-details p {
        margin: 0.5rem 0;
        font-size: 0.95rem;
        color: #555;
        line-height: 1.5;
    }

    .product-details strong {
        color: #333;
        font-weight: 600;
    }

    /* Product Image - Updated */
    .product-image {
        width: 120px;
        height: 120px;
        flex-shrink: 0;
        border-radius: 8px;
        overflow: hidden;
    }

    .product-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 8px;
    }

    /* Status Update Section */
    .status-update-container {
        margin-top: 2rem;
        padding: 1.5rem;
        background-color: #f8f9fa;
        border-radius: 12px;
    }

    .status-update-container select {
        padding: 0.75rem 1rem;
        font-size: 0.95rem;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        width: 200px;
        margin-right: 1rem;
        background-color: white;
    }

    .status-update-container button {
        padding: 0.75rem 1.5rem;
        font-size: 0.95rem;
        border: none;
        border-radius: 8px;
        background-color: #4f46e5;
        color: white;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .status-update-container button:hover {
        background-color: #4338ca;
    }

    /* Footer Section */
    .footer {
        margin-top: 2rem;
        padding-top: 1.5rem;
        border-top: 2px solid #f1f1f1;
    }

    .footer p {
        font-size: 1rem;
        margin: 0.75rem 0;
        color: #444;
    }

    .footer p strong {
        color: #333;
    }

    /* Address Section */
    .address-section {
        padding: 1.5rem;
        background-color: #f8f9fa;
        border-radius: 12px;
        margin: 1.5rem 0;
    }

    .address-section p {
        margin: 0.5rem 0;
        line-height: 1.6;
    }
</style>

<body>
<div class="order-container">
    <!-- Order Header -->
    <div class="order-header">
        <% function getStatusBadgeClass(status) { 
            switch (status) {
                case "Pending": return "bg-warning text-dark"; 
                case "Processing": return "bg-primary"; 
                case "Shipped": return "bg-info text-dark"; 
                case "Delivered": return "bg-success"; 
                case "Cancelled": return "bg-danger"; 
                case "Return Request": return "bg-secondary"; 
                case "Returned": return "bg-dark"; 
                default: return "bg-light text-dark"; 
            }
        } %>
        <p>Order ID:<%=orders.orderId %></p>
        <span class="status-badge <%= getStatusBadgeClass(orders.status) %>">
            <%= orders.status %>
        </span>
    </div>

    <p><strong>Invoice Date:</strong> <%= new Date(orders.createdAt).toLocaleDateString() %></p>
    <p><strong>Payment Method:</strong> <%= orders.paymentMethod %></p>
    <p><strong>Coupon Applied:</strong> <%= orders.couponApplied %></p>

    <div class="address-section">
        <p><strong>Delivery Address:</strong></p>
        <p><%= address.name %><br><%= address.landMark%> <%=address.city%> <%=address.state%>,<%=address.country%> <%=address.pincode%><br><%=address.phone %></p>
    </div>

    <% if (products && products.length > 0) { %>
        <% products.forEach((item) => { %>
            <div class="product-box">
                <div class="product-details">
                    <p><strong>Product Name:</strong> <%= item.productName %></p>
                    <p><strong>Quantity:</strong> <%= item.quantity %></p>
                    <p><strong>Price:</strong> ₹<%= item.price %></p>
                    <p><strong>Total:</strong> ₹<%= item.total %></p>
                </div>
                <!-- Product Image Section -->
                <div class="product-image">
                    <img src="/uploads/re-image/<%= item.productImage[0] %>" 
                         alt="<%= item.productName %>"
                         onerror="this.src='/images/default-image.jpg'">
                </div>
            </div>
        <% }) %>
    <% } %>
    <!-- Status Update Section -->
    <div class="status-update-container">
        <label for="orderStatus">Update Order Status: </label>
        <select id="orderStatus">
            <option value="Pending">Pending</option>
            <option value="Processing">Processing</option>
            <option value="Shipped">Shipped</option>
            <option value="Delivered">Delivered</option>
            <option value="Cancelled">Cancelled</option>
            <option value="Return Request">Return Request</option>
            <option value="Returned">Returned</option>
        </select>
        <button id="updateStatusBtn">Update Status</button>
    </div>
    
    <!-- Footer Section -->
    <div class="footer">
        <p><strong>Total Price:</strong> ₹<%= orders.totalPrice %></p>
        <p><strong>Discount:</strong> ₹<%= orders.discount %></p>
        <p><strong>Final Amount:</strong> ₹<%= orders.finalAmount %></p>
    </div>

    <!-- Toggle Button to Change Status -->
    <button class="toggle-btn" id="toggleStatusBtn">Change Status</button>
</div>

<script>
    // Handle order status update
    document.getElementById("updateStatusBtn").addEventListener("click", function() {
        var status = document.getElementById("orderStatus").value;
        alert("Order status updated to: " + status);
        // Add your logic here to send the status update request to the server
    });
</script>



<%- include("../partials/admin/footer") %>